(()=>{"use strict";const t=function(){var t=document.querySelector(".lang-active").getAttribute("lang");return"eng"===t?{greeting:["Good night","Good morning","Good afternoon","Good evening"],placeholder:"[Enter name]",weather:{local:"Minsk",lang:"en",wind:["Wind speed:","m/s"],humidity:"Humidity:"},quotes:"assets/json/quotesEng.json",localDate:"en-US",settings:{lang:["EN","RU"],titles:["language:","Images:","Elements:"],elements:["Time","Date","Quotes","Audio","Weather","Greeting","Game"]}}:"rus"===t?{greeting:["Доброй ночи","Доброе утро","Добрый день","Добрый вечер"],placeholder:"[Введите имя]",weather:{local:"Минск",lang:"ru",wind:["Скорость ветра:","м/с"],humidity:"Влажность:"},quotes:"assets/json/quotesRus.json",localDate:"ru-RU",settings:{lang:["АНГ","РУС"],titles:["Язык:","Изображение:","Элементы:"],elements:["Время","Дата","Цитаты","Аудио","Погода","Приветствие","Игра"]}}:void 0},e=function(){var e=document.querySelector(".greeting"),n=document.querySelector(".name"),o=(new Date).getHours(),c=Math.floor(o/6);e.textContent="".concat(t().greeting[c]),n.setAttribute("placeholder",t().placeholder)},n=function(){var n,o=new Date,c=o.toLocaleTimeString(),a=o.toLocaleDateString(t().localDate,{weekday:"long",month:"long",day:"numeric"}),r=document.querySelector(".time"),i=document.querySelector(".date");n=c,r.textContent="".concat(n),function(t){i.textContent="".concat(t)}(a),e()},o=function(t,e){var n=document.querySelector(e);window.addEventListener("beforeunload",(function(){localStorage.setItem(t,n.value)})),window.addEventListener("load",(function(){localStorage.getItem(t)&&(n.value=localStorage.getItem(t))}))},c=function(){var t=(new Date).getHours();return["night","morning","afternoon","evening"][Math.floor(t/6)]},a=function(t){return Math.ceil(Math.random()*t)},r=function(){var e=document.querySelector(".weather-icon"),n=document.querySelector(".temperature"),c=document.querySelector(".weather-description"),a=document.querySelector(".city"),r=document.querySelector(".wind"),i=document.querySelector(".humidity"),s=document.querySelector(".weather-error");function l(){o("city",".city");var l="https://api.openweathermap.org/data/2.5/weather?q=".concat(a.value,"&lang=").concat(t().weather.lang,"&appid=8c4c964ebe4513067fc46e6f50e27023&units=metric");fetch(l).then((function(t){return t.json()})).then((function(o){return function(o){s.textContent="",e.className="weather-icon owf",e.classList.add("owf-".concat(o.weather[0].id)),n.textContent="".concat(Math.round(o.main.temp),"°C"),c.textContent=o.weather[0].description,r.textContent="".concat(t().weather.wind[0]," ").concat(Math.round(o.wind.speed)," ").concat(t().weather.wind[1]),i.textContent="".concat(t().weather.humidity,"  ").concat(o.main.humidity,"%")}(o)})).catch((function(t){return s.textContent="Error! city not found for ".concat(a.value,"!"),e.className="weather-icon owf",n.textContent="",c.textContent="",r.textContent="",void(i.textContent="")}))}localStorage.getItem("city")?a.setAttribute("value",localStorage.getItem("city")):a.setAttribute("value",t().weather.local),a.addEventListener("change",l),l()},i=function e(){var n=document.querySelector(".quote"),o=document.querySelector(".author"),c=document.querySelector(".change-quote"),r=t().quotes;fetch(r).then((function(t){return t.json()})).then((function(t){var e=a(t.quotes.length);n.textContent="".concat(t.quotes[e].quote),o.textContent="".concat(t.quotes[e].author)})).catch((function(t){return console.log(t)})),c.addEventListener("click",e)},s=[{title:"Aqua Caelestis",src:"assets/sounds/Aqua Caelestis.mp3",duration:"00:39"},{title:"River Flows In You",src:"assets/sounds/River Flows In You.mp3",duration:"01:37"},{title:"Ennio Morricone",src:"assets/sounds/Ennio Morricone.mp3",duration:"01:37"},{title:"Summer Wind",src:"assets/sounds/Summer Wind.mp3",duration:"01:50"}];window.addEventListener("DOMContentLoaded",(function(){setInterval(n,1e3),o("name",".name"),function(){var t=document.querySelector(".settings-images"),e=document.querySelector(".slide-next"),n=document.querySelector(".slide-prev"),o=document.querySelector("body"),r=c(),i=document.querySelector(".tag-img-api"),s="rss",l=c();localStorage.getItem("isAPI")&&(s=localStorage.getItem("isAPI")),document.querySelectorAll(".api").forEach((function(t){t.getAttribute("id")===s&&t.classList.add("active-api")})),i.addEventListener("change",(function(){l=""!==i.value?i.value:c(),"unsplash"===s?d():"flickr"===s&&m()}));var u=a(20);function d(){s="unsplash",localStorage.setItem("isAPI",s);var t="https://api.unsplash.com/photos/random?orientation=landscape&query=".concat(l,"&client_id=DQ2dbKPFM0Z06fd7ZUhO-SNeF2i36l0UEEm9aswMmbE");fetch(t).then((function(t){return t.json()})).then((function(t){var e=new Image;e.src=t.urls.regular,e.onload=function(){o.style.backgroundImage="url(".concat(t.urls.regular,")")}}))}function m(){s="flickr",localStorage.setItem("isAPI",s);var t="https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=54f3bc345f95e26611b0a5ba3a08e328&tags=".concat(l,"&extras=url_l&format=json&nojsoncallback=1");fetch(t).then((function(t){return t.json()})).then((function(t){console.log(t.photos.photo[a(t.photos.photo.length-1)].url_l);var e=new Image;e.src=t.photos.photo[a(t.photos.photo.length-1)].url_l,e.onload=function(){o.style.backgroundImage="url(".concat(t.photos.photo[a(t.photos.photo.length-1)].url_l,")")}}))}function g(){var t=u;s="rss",t<10&&(t=u.toString().padStart(2,"0"));var e=new Image;e.src="https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/".concat(r,"/").concat(t,".jpg"),e.onload=function(){o.style.backgroundImage="url('https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/".concat(r,"/").concat(t,".jpg')")}}g(),e.addEventListener("click",(function(){"rss"===s?(u<20?u++:u=1,g()):"unsplash"===s?d():"flickr"===s&&m()})),n.addEventListener("click",(function(){"rss"===s?(u>1?u--:u=20,g()):"unsplash"===s?d():"flickr"===s&&m()})),t.addEventListener("click",(function(t){t.target.classList.contains("settings-btn")&&(t.target.classList.contains("active-api")||(document.querySelectorAll(".api").forEach((function(t){return t.classList.remove("active-api")})),t.target.classList.add("active-api"),"RSS"===t.target.textContent?(g(),localStorage.setItem("isAPI",s),document.querySelector(".tag-img-api").classList.remove("show-input-tag"),document.querySelector(".tag-img-api").classList.add("hide-input-tag")):"Unsplash"===t.target.textContent?(d(),document.querySelector(".tag-img-api").classList.remove("hide-input-tag"),document.querySelector(".tag-img-api").classList.add("show-input-tag")):"Flickr"===t.target.textContent&&(m(),document.querySelector(".tag-img-api").classList.remove("hide-input-tag"),document.querySelector(".tag-img-api").classList.add("show-input-tag"))))}))}(),r(),i(),function(){var t=document.querySelector(".play"),e=document.querySelector(".play-prev"),n=document.querySelector(".play-next"),o=document.querySelector(".play-list"),c=document.querySelector(".active-sound-title"),a=document.querySelector(".duration"),r=document.querySelector(".play-current"),i=document.querySelector(".progress"),l=document.querySelector(".timeline"),u=document.querySelector(".leavelline"),d=document.querySelector(".volume-leavel"),m=document.querySelector(".volume-btn"),g=new Audio,h=!1,f=0,p=0;function v(){c.textContent="".concat(s[f].title),d.style.width="".concat(g.volume*u.clientWidth,"px")}function y(t){var e=document.createElement("li");e.classList.add("play-item"),o.append(e),e.innerHTML="<h3>".concat(s[t].title,'</h3><button class="play player-icon btn-item" data-item="').concat(t,'"></button>')}function S(t){var e=t.srcElement,n=e.duration,o=e.currentTime,c=o/n*100,a=parseInt(o/60).toString().padStart(2,"0"),s=parseInt(o%60).toString().padStart(2,"0");i.style.width="".concat(+c,"%"),r.textContent="".concat(a,":").concat(s),v()}function q(){h?(g.src=s[f].src,g.play(),document.querySelectorAll(".btn-item").forEach((function(t){return t.classList.remove("pause")})),t.classList.add("pause"),document.querySelectorAll(".play-item").forEach((function(t){t.classList.remove("item-active")})),document.querySelectorAll(".btn-item")[f].classList.add("pause"),document.querySelectorAll(".play-item")[f].classList.add("item-active"),g.addEventListener("timeupdate",S)):(g.pause(),t.classList.remove("pause"),document.querySelectorAll(".play-item").forEach((function(t){t.classList.remove("item-active")})),document.querySelectorAll(".btn-item").forEach((function(t){return t.classList.remove("pause")})))}for(var L=0;L<s.length;L++)y(L);g.addEventListener("loadeddata",(function(t){var e=t.srcElement.duration,n=parseInt(e/60).toString().padStart(2,"0"),o=parseInt(e%60).toString().padStart(2,"0");a.textContent="".concat(n,":").concat(o)})),l.addEventListener("click",(function(t){var e=this.clientWidth,n=t.offsetX,o=g.duration;g.currentTime=n/e*o})),u.addEventListener("click",(function(t){var e=this.clientWidth,n=t.offsetX;g.volume=n/e,d.style.width="".concat(g.volume*e,"px")})),m.addEventListener("click",(function(){m.classList.contains("volume-active")?(m.classList.remove("volume-active"),d.setAttribute("value","".concat(g.volume)),g.volume=0):(m.classList.add("volume-active"),g.volume=d.getAttribute("value"))})),g.addEventListener("ended",(function(){f++,q()})),t.addEventListener("click",(function(){!1===h?(h=!0,q()):(h=!1,p=g.currentTime,console.log(p),q())})),e.addEventListener("click",(function(){f>0?(f--,h=!0,q()):0===f&&(f=s.length-1,h=!0,q())})),n.addEventListener("click",(function(){f<s.length-1?(f++,h=!0,q()):f===s.length-1&&(f=0,h=!0,q())})),o.addEventListener("click",(function(t){!0===h?(h=!1,q()):(h=!0,f=+t.target.getAttribute("data-item"),q())})),v()}(),function(){var o=document.querySelectorAll(".lang"),c="eng";function a(){o.forEach((function(e){"eng"===e.getAttribute("lang")?e.textContent="".concat(t().settings.lang[0]):"rus"===e.getAttribute("lang")&&(e.textContent="".concat(t().settings.lang[1]))}))}localStorage.getItem("lang")&&(c=localStorage.getItem("lang"),o.forEach((function(t){t.classList.remove("lang-active"),t.getAttribute("lang")===c&&(console.log(t.getAttribute("lang")),t.classList.add("lang-active"))})),a(),i(),r(),n()),a(),o.forEach((function(c){c.addEventListener("click",(function(){if(!c.classList.contains("lang-active")){o.forEach((function(t){return t.classList.remove("lang-active")})),c.classList.add("lang-active"),localStorage.setItem("lang",c.getAttribute("lang")),t(),e(),r(),i(),n(),a();var s=document.querySelectorAll(".condition"),l=document.querySelectorAll(".settings-titles");s.forEach((function(e,n){e.textContent="".concat(t().settings.elements[n])})),l.forEach((function(e,n){e.textContent="".concat(t().settings.titles[n])}))}}))}))}(),function(){var e=document.querySelector(".settings-wrapper"),n=document.querySelector(".settings-icon"),o=document.querySelectorAll(".condition"),c=document.querySelectorAll(".settings-titles"),a={blocks:["time","date","weather-test","player","greeting-container","quotes-block"]};function r(t,e,n){t.classList.remove(n),t.classList.add(e),a.blocks.splice(a.blocks.indexOf(t.getAttribute("selector")),1),localStorage.setItem("state",JSON.stringify(a))}function i(t,e,n){t.classList.remove(n),t.classList.add(e)}localStorage.getItem("state")&&(a=JSON.parse(localStorage.getItem("state"))),a.blocks.forEach((function(t){o.forEach((function(e){e.getAttribute("selector")===t&&(e.classList.add("active-api"),i(document.querySelector(".".concat(e.getAttribute("selector"))),"show-block","hide-block"))}))})),n.addEventListener("click",(function(){n.classList.contains("open")?(n.classList.remove("open"),n.classList.add("close"),r(e,"close-settings","open-settings")):(n.classList.remove("close"),n.classList.add("open"),i(e,"open-settings","close-settings"))})),o.forEach((function(t){t.addEventListener("click",(function(){t.classList.contains("active-api")?(t.style.display="block",t.classList.remove("active-api"),r(document.querySelector(".".concat(t.getAttribute("selector"))),"hide-block","show-block")):(t.classList.add("active-api"),a.blocks.push(t.getAttribute("selector")),localStorage.setItem("state",JSON.stringify(a)),i(document.querySelector(".".concat(t.getAttribute("selector"))),"show-block","hide-block"))}))})),o.forEach((function(e,n){e.textContent="".concat(t().settings.elements[n])})),c.forEach((function(e,n){e.textContent="".concat(t().settings.titles[n])}))}()}))})();